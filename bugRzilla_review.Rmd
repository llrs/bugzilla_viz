---
title: "R bugzilla review"
author: "Piyush Kumar"
advisors: "Llu√≠s Revilla, Heather Turner"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
    prettydoc::html_pretty:
        theme: cayman
        toc: true
        toc_depth: 3 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<style>
body {
    text-align: justify;
}
</style>

# Introduction

<font size="4">

## What is the bugRzilla Package?

BugRzilla is an R package that helps the user to interact with the **Bugzilla** through an API.

<font size="3">To learn more, see [bugRzilla](https://github.com/llrs/bugRzilla).</font>

## About the BugRzilla Google Summer of COde Project:-

The project bugRzilla is an issue tracker for the R-core members. The goal of the project is to help users to submit issues to R Bugzilla.

## About the This Project:-

Explore the issues and bugs on the R Bugzilla to make the submission from bugRzilla better. It might help to identify useful patterns for R core or report the status of the R Bugzilla.
</font>

<font size="3">To learn more, see [bugzilla_viz](https://github.com/llrs/bugzilla_viz).</font>

# Setup Database on your local system

## Download SQL and MySQL Workbench

<font size="4">
To install SQL on Ubuntu one can refer a blog post by [digitalocean](https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-ubuntu-20-04).
To install MySQL workbench on Ubuntu one can refer a blog post by [linuxhint](https://linuxhint.com/installing_mysql_workbench_ubuntu/)
</font>

## Download R_bugzilla data 

<font size ="4">
<ol>
<li>
The R_bugzilla data can be downloaded from  [link](https://bugs.r-project.org/db/R-bugs.sql.xz).
</li>
<li>
Since the downloaded data is a zip file so make sure you unzip the file before dumping the file
which will have an extension `.sql` (eg: R-bugs.sql).
</li>
</ol>
</font>

## Dump downloaded R_bugzilla to MySQL workbench.

<font size="4">
Before one import the R_bugzilla SQL file one may need to create the (empty) database from MySQL if it doesn't exist already and the exported SQL don't contain CREATE DATABASE (exported with --no-create-db or -n option), before you can import it.


After considering this open your Terminal and run the command: `mysqldump -u my_username -p database_name > output_file_path`

The options in use are:
<ol>
<li>
The `-u` flag indicates that the MySQL `username` will follow.
</li>
<li>
The `-p` flag indicates we should be prompted for the `password` associated with the above username.
`database_name` is of course the exact name of the database to export.
</li>
<li>
The `>` symbol is a Unix directive for `STDOUT`, which allows Unix commands to output the text results of the issued command to another location. In this case, that output location is a file path, specified by `output_file_path`.
</li>
</ol>
</font>

# bugRzilla Analysis

<font size="4">
For the connection to the database, I'm using the `dplyr` package, it supports to the widely-used open source databases like `MySQL`.
</font>

## The libraries used for the analysis:

```{r, }
# loading packages
library(dplyr)
library(dbplyr)
library(RMySQL)
library(DBI)
library(DT)
library(tidyverse)
library(ggplot2)
library(plotly)
```

## Connect bugRzilla SQL Database with R

```{r}
# Connecting R with MySQL
con <- dbConnect(
    MySQL(),
    dbname='bugRzilla', # change the database name to your database name
    username='root', # change the username to your username
    password='1204', # update your password
    host='localhost',
    port=3306)

#  Accessing Tables names from the Database
DBI::dbListTables(con)
```

## Data Exploartion of Bugs Table from the Database
```{r}
bugs_df <- tbl(con, "bugs")
```

```{r}
# Converting `bugs_df` to `dataframe` and showing the `datatable`
bugs_df <- as.data.frame(bugs_df)
datatable(bugs_df, options = list(scrollX = TRUE,
                                                 pageLength = 5, lengthMenu = c(5, 10, 50, 100)))
```

<font size="4">
From the above table we can conclude that the few of the columns are having wrong datatype like:
<ol>
    <li>
        creation_ts
    </li>
    <li>
        delta_ts
    </li>
    <li>
        estimated_time
    </li>
    <li>
        remaining_time
    </li>
    <li>
        deadline
    </li>
</ol>
Also there are columns which are empty so they are of no use of the analysis like:
<ol>
    <li>
        target_milestone
    </li>
    <li>
        qa_contact
    </li>
    <li>
        status_whiteboard
    </li>
</ol>
</font>

### Cleaning the data

<font size="4">
    First steps, check the data and prepare it for what we want:
</font>

```{r}
bugs_df <- bugs_df %>%
    mutate_at(vars("creation_ts", "delta_ts", "lastdiffed", "deadline"), as.Date)
```

### Visualizations

```{r}
# Line plot for creation_ts, delta_ts, deadline
creation <- bugs_df$creation_ts
delta <- bugs_df$delta_ts
deadline <- bugs_df$deadline
last_diffed <- bugs_df$lastdiffed
bug_id <- bugs_df$bug_id
component_id <- bugs_df$component_id
resolution <- bugs_df$resolution


data <- data.frame(bug_id, creation)
fig <- plot_ly(data, y = ~bug_id, x = ~creation, type = 'scatter', mode = 'markers')
fig

data <- data.frame(bug_id, delta)
fig <- plot_ly(data, y = ~bug_id, x = ~delta, type = 'scatter', mode = 'markers')
fig

data <- data.frame(bug_id, deadline)
fig <- plot_ly(data, y = ~bug_id, x = ~deadline, type = 'scatter', mode = 'markers')
fig

# bar plot with bug_id and resolution 
data <- data.frame(bug_id, resolution)
fig <- plot_ly(data, x = ~resolution, y = ~bug_id, name = 'creation', type = 'bar')
fig

```
